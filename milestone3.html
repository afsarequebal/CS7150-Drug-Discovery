<!doctype html>
<html lang="en">
  <head>
    <title>CS 7150 Drug Discovery</title>
    <meta property="og:title" content="Your Project Name" />
    <meta name="twitter:title" content="Your Project Name" />
    <meta name="description" content="Your project about your cool topic
      described right here." />
    <meta property="og:description" content="Your project about your cool topic
      described right here." />
    <meta name="twitter:description" content="Your project about your cool topic
      described right here." />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- bootstrap for mobile-friendly layout -->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous">
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700"
      rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <style>
.fcc-btn {
  float: left;
}
</style>
  </head>
  <body class="nd-docs">
    <div class="nd-pageheader">
      <div class="container">
        <h1 class="lead">
          <nobr class="widenobr">Graph Convolutions and Drug Discovery</nobr>
          <nobr class="widenobr">For CS 7150</nobr>
        </h1>
      </div>
    </div><!-- end nd-pageheader -->

    <div class="container"> <!-- container 123 -->
      <div class="row"> <!-- row abc -->
        <div class="col justify-content-center text-center"> <!-- cell w/ link to previous write-ups -->
          <h4 style="color:white">
            <a href="index.html">Proposal and Milestone</a></h4>
          <h1>
            Final Report
          </h1>
          <h2>
            Can Graph Convolutions Improve Drug Discovery for Alzheimer's
            Disease?
          </h2>
        </div>
      </div> <!-- end row abc -->
      <br>
      <br>
      <div class="row"> <!-- row introduction -->
        <div class="col">
          <h3>Introduction</h3>
          <p>
            The use of neural networks to predict novel treatments of disease is
            widespread, and includes many areas of medicine and disease.
            Alzheimer's Disease is a  well known disease that impacts the lives of many people. The
            amyloid peptides play a large role in the pathogenesis of the
            disease,largely related to their dysfunction <a
              href="https://pubmed.ncbi.nlm.nih.gov/24493463/">[2]</a>. Although
            the Disease impacts such a large population,
            little is known about the underlying biological mechanism as a
            whole, and thus treatments are limited.
            <br><br>
            In 2020, Collins and colleagues <a
              href="https://www.sciencedirect.com/science/article/pii/S0092867420301021?via%3Dihub">[1]</a>
            were able to utilize graph convolutions to produce trainable
            molecular features for use in their neural networks.
            These trainable features were then fed into a feed-forward neural
            network to predict the binary outcome; if the compund
            would act as an antibiotic towards E. coli. This new utilization of
            graph neural networks to train molecular features led to
            the discovery of a novel antibiotic, one that was structurally
            unique to other antibiotics. The proposed project for this course
            involves the reproduction and alteration of Collins work with
            antibiotics to predict novel compounds which may be effective in the treatment of
            Alzheimer's Disease, via interaction with the amyloid peptide. <br><br>
          </p>
          <hr>
        </div>
        <br><br>
      </div> <!-- end row introduction -->
      <div class="row"> <!-- row background -->
        <div class="col">
          <h3>Background</h3>
        </div>
      </div> <!-- end row background -->

      <br><br>

      <div class="row"> <!-- row background1 - message passing row -->
        <div class="col"> <!-- col text for mpn -->
          <p>
            The figure to the right describes the message passing functions
            of graph neural network. We decided to work with graphs becuase
            molecular structure resembles a graph such that the atoms are
            represented by nodes and bonds are
            represented by edges.
            The features of a atoms like atom type are represented in a matrix
            format. So the node embedding update phase just requires matrix
            multiplication with graph filters. The size of the filter is decided
            by
          </p>
        </div> <!-- end col text for mpn -->

        <div class="col"> <!-- col mpnimage with message pass image -->
          <img style="border:1px solid black;" src="mainDiagram.png", alt="Graph
            Neural Network" width="600">
          <br>
        </div> <!-- end col mpnimage -->
        <br><br>
      </div><!-- end row background1 -->

      <br><br>

      <div class="row"> <!-- row background2 - message passing row -->

        <div class="col"> <!-- col text for laplacian -->
          <p>
            text for the second image (we can also convert the three images on
            the right into a single
            tall image, and that would make the text on the left hand side more
            clean. )
          </p>
        </div> <!-- end col text for graph laplacian -->

        <div class="col"> <!-- col laplacian image -->
          <img style="border:1px solid black;" src="laplacian.png", alt="Graph
            Neural Network" width="600">
          <br>
        </div> <!-- end col graph_laplacian image -->
        <br><br>
      </div><!-- end row background2 -->

      <br><br>

      <div class="row"> <!-- row background3 - math row -->

        <div class="col"> <!-- col text for math -->
          <p>
            text for the third image .afafaewfagaegr
          </p>
        </div> <!-- end col text for math -->

        <div class="col"> <!-- col math image -->
          <img style="border:1px solid black;" src="nodeEmbedding.png",
            alt="Graph
            Neural Network" width="600">
          <br>
        </div> <!-- end col math image -->

      </div><!-- end row background3 -->
      <br><br>
      <hr>
      <div>
        <h3>Method</h3>
        <br>
        <h5>Data Collection</h5>
        <p>
          Compound and training data was collected from the PubChem Online
          Database. PubChem comtains chemical information
          for more than 9 billion compounds and the results of thousands of
          experiments performed in labs across the world. For
          this analysis, we used experimental data from PubChem Bioassay 1285
          (INSERT LINK). This assay evaluated 193,771 compounds
          in their ability to inhibit levels of Amyloid Precursor Protein (APP).
          Of these 193,771 compounds, we were able to use the
          PubChem compound database to extract relevant chemical information
          (SMILES) for each of the compounds.
          <br><br>
          For the nomination data, chemical information for 10,000 compounds
          were downloaded from the ChembL database,
          another well known chemical library. The purpose of the nomination set
          is to nominate new compounds that have yet to be
          tested in a lab for their ability to reduce levels of the protein. For
          this reason the 10,000 compounds chosen were
          confirmed to not exist in the 193,771 compounds included in the
          training data.
          <br><br>
          <h5>Data Preparation</h5>
          <p>
            DeepChem is a Python library/framework that is often used in the
            Deep Learning and Chemistry fields.
            The framework has integrated many deep learning models and
            functionalities from both PyTorch and TensorFlow.
            Following the extraction of standard chemical data from PubChem,
            graph representations of the molecules were
            needed to pass into our Graph Neural Network models. DeepChem
            provides a function, <i>ConvMolFeaturizer()</i>
            which easily converts approriately formatted graph representations
            by passing in SMILES representations of each
            compound into the function.
            <br><br>
            Due to the nature of drug discovery, the large majority of compounds
            evaluated for activity on proteins
            do not show any activity or impact on levels of the protein. This
            leads to a highly imbalanced dataset.
            In order to account for this, prior to training our models we used
            the DeepChem function <i>BalancingTransformer()</i>
            to minimize the impact of class imbalance on classification tasks.
            The <i>BalancingTransformer</i> function
            accomplishes this by balancing the class weights of both classes, to
            ensure similar impact on model training from
            both classes.
            <br><br>
            The data was split into training, validation, and test sets in a
            80:10:10 ratio. Only 0.89% of tested compounds
            showed activity against the Amyloid Precursor Protein, thus we split
            the data using the <i>RandomStratifiedSplitter()</i>
            function within DeepChem. This ensured the training, validation, and
            test set had equally proportional data in terms of
            class balance.
            <br><br>
            <h5>Model Training</h5>
            The GraphConvModel provided by DeepChem was used as the baseline
            Graph Neural Network model for our analyses. From this model
            we tuned the parameters to determine which architecture provided the
            best performance on our validation set. The architecture
            of the final model included: <br><br>
            <ul>
              <li>Four graph convolutional layers</li>
              <li>One feed-forward fully connected layer</li>
              <li>Dropout (p = 0.5)</li>
              <li>Batch Normalization</li>
              <li>Softmax Function</li>
            </ul>
            The parameters chosen to optimize the model: <br><br>
            <ul>
              <li>ADAM optimizer</li>
              <li>Learning Rate 0.001</li>
              <li>50 epochs</li>
              <li>Cross-Entropy Loss Function</li>
            </ul>
          </p>
        </div>
        <br><br>
        <hr>
        <h3>Results</h3>
        <br>
        <div class="row"> <!-- row background1 - message passing row -->
          <div class="col"> <!-- col text for mpn -->
            <p>
              here is the first paragraph fr the resultsere is the first
              paragraph fr the r
              ere is the first paragraph fr the results esultsere is the first
              paragraph fr
              the results ere is the first paragraph fr the results
              ere is the first paragraph fr the resultsere is the first
              paragraph fr the results
              ere is the first paragraph fr the results
            </p>
          </div> <!-- end col text for mpn -->

        </div><!-- end row background1 -->

        <br><br>




        <div class="row"> <!-- row -->
          <div class="col"> <!-- col  -->
            <br><br>
            <h5>Graph Neural Network Model Results</h5>
            <br><br>
          </div> <!-- end col -->
        </div> <!-- end row -->

        <div class="row"> <!-- row nomination images-->
          <div class="col"> <!-- col nomination images 1 -->
            <h5>CHEMBL1981307</h5>
            <img style="border:1px solid black;" src="drug_1.png",
              alt="Graph
              Neural Network" height="180">
          </div> <!-- end col nomination images 1 -->

          <div class="col"> <!-- col nomination images 2 -->
            <h5>CHEMBL224682</h5>
            <img style="border:1px solid black;" src="drug_2.png",
              alt="Graph
              Neural Network" height="180">
            <br>
          </div> <!-- end col nomination images 2 -->

          <div class="col"> <!-- col nomination images 3 -->
            <h5>CHEMBL234282</h5>
            <img style="border:1px solid black;" src="drug_3.png",
              alt="Graph
              Neural Network" height="180">
            <br>
          </div> <!-- end col nomination images 3 -->
        </div> <!-- end row nomination images-->


        <br><br>
        <hr>
        <h4>Next Steps</h4>
        <br><br>
        <hr>

        <ul>
          <li> Model building : The current model implemented in our project
            is the out-of-the-box model provided by DeepChem. We would like to
            use our current results to
            build off of this model and create custom layers and parameters.
          </li>
          <li> Experiment and performance comparison(In progress): We will use
            support vector machine as an alternative model. It takes Morgan
            fingerprint as an input \
            and performs classification. We will then do comparison of the
            performance of neural network model and SVM. If time permits we
            will try to build random forest model and compare its performance
            with feed-forward neural network model
          </li>
        </ul>


        <br>
        <h5><a
            href='https://github.com/hjombach/Drug_Discovery_Alzheimers_Protein'>
            GitHub Link</a></h5>
        <br>
        <hr>
        <h3>References</h3>


        <h2>Team Members</h2>

        <p>Afsar Equebal and Hendrik Ombach. <br>


          <!--col</div>--col-->
        </div><!-- end row cat -->
      </div> <!-- end container 123 -->

      <footer class="nd-pagefooter">
        <div class="row">
          <div class="col-6 col-md text-center">
            <a href="https://cs7150.baulab.info/">About CS 7150</a>
          </div>
        </div>
      </footer>

    </body>
    <script>
$(document).on('click', '.clickselect', function(ev) {
  var range = document.createRange();
  range.selectNodeContents(this);
  var sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
});
// Google analytics below.
window.dataLayer = window.dataLayer || [];
</script>
  </html>



  <!-- 
        <img style="border:1px solid black;"src="laplacian.png" alt="Graph Neural Network" width="500">
          <br>
        <p>
          Filter 
        </p> -->
  <!-- <img style="border:1px solid black;" src="nodeEmbedding.png" alt="Graph Neural Network" width="500"><br>
        <p> Node embedding update</p>
        <br><br>
        <hr>

        <br><br>
        <hr> -->